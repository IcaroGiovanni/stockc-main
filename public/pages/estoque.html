<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Estoque - StockCtrl</title>
    <!-- Font Awesome para √çcones -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <!-- Estilos Principais -->
    <link rel="stylesheet" href="../css/estoque-moderno.css">
    <!-- Estilos da Logo (pode ser integrado no principal depois) -->
    <link rel="stylesheet" href="../css/logo-animada.css">
    <!-- Importa√ß√£o do TailwindCSS que estava faltando -->
    <script src="https://cdn.jsdelivr.net/npm/tailwindcss@3.4.1/lib/index.min.js"></script>
</head>
<body>
    <!-- Bot√£o Hamburger para Mobile -->
    <button class="mobile-menu-toggle hidden" id="mobile-menu-toggle">
        <i class="fas fa-bars"></i>
    </button>
    
    <!-- Sidebar (Estrutura existente) -->
    <aside class="sidebar">
        <div class="logo-container">
            <a href="/dashboard" class="logo-link">
                <span class="logo-sc">SC</span>
                <span id="company-name-sidebar" class="logo-company-name">STOCKCTRL</span>
            </a>
        </div>
        <nav>
            <a href="/dashboard"><i class="fas fa-chart-pie"></i> Dashboard</a>
            <a href="/estoque" class="active"><i class="fas fa-boxes-stacked"></i> Estoque</a>
            <a href="/usuarios"><i class="fas fa-users"></i> Usu√°rios</a>
            <a href="/logs"><i class="fas fa-history"></i> Logs de Atividade</a>
            <a href="/configuracoes"><i class="fas fa-cog"></i> Configura√ß√µes</a>
        </nav>
        <div class="sidebar-footer">
            <div class="user-profile-widget">
                <img id="user-avatar" src="" alt="Avatar">
                <span id="user-name"></span>
            </div>
            <a href="#" id="logout-btn" title="Sair"><i class="fas fa-sign-out-alt"></i></a>
        </div>
    </aside>

    <!-- Conte√∫do Principal (Nova Estrutura) -->
    <main class="main-content">

        <!-- Cabe√ßalho -->
        <div class="main-header">
            <h1 class="premium-title">Gerenciamento de Estoque</h1>
            <div id="total-container">
                Total de Produtos: <span id="total-value">0</span>
            </div>
            <div class="estoque-actions" style="display:flex;gap:10px;align-items:center;">
                <button id="btn-export-xlsx" class="btn btn-primary btn-xl" style="display:flex;align-items:center;gap:8px;min-width:120px;" title="Exportar planilha"><i class="fas fa-file-excel"></i> <span>Exportar</span></button>
                <label for="input-import-xlsx" class="btn btn-primary btn-xl" style="margin-bottom:0;cursor:pointer;display:flex;align-items:center;gap:8px;min-width:120px;">
                    <i class="fas fa-file-import"></i> <span>Importar</span>
                    <input id="input-import-xlsx" type="file" accept=".xlsx" style="display:none;">
                </label>
            </div>
        </div>

        <!-- Controles (Busca) -->
        <div class="controls-container glass-panel">
            <div class="search-container">
                <i class="fas fa-search"></i>
                <input type="text" id="search-input" class="neo-input" placeholder="Buscar por nome do produto...">
            </div>
        </div>

        <!-- Tabela de Produtos -->
        <div class="table-container glass-panel">
            <table>
                <thead>
                    <tr>
                        <th data-sort-key="name">Nome do Produto <i class="fas fa-sort sort-icon"></i></th>
                        <th>Localiza√ß√£o & Quantidade</th>
                        <th>Total</th>
                        <th style="text-align: center;">A√ß√µes</th>
                    </tr>
                </thead>
                <tbody id="inventory-table-body">
                    <!-- Linhas da tabela ser√£o inseridas aqui pelo JavaScript -->
                </tbody>
            </table>
        </div>

    </main>

    <!-- Bot√£o Flutuante para Adicionar Produto -->
    <button class="fab-add" id="fab-add-product">
        <i class="fas fa-plus"></i>
    </button>

    <!-- Modal de Adicionar/Editar Produto -->
    <div id="product-modal-overlay" class="modal-overlay hidden">
        <div class="modal-content">
            <div class="modal-header">
                <h2 class="premium-title" id="modal-title">Adicionar Novo Produto</h2>
                <button class="close-button" id="close-modal-btn"><i class="fas fa-times"></i></button>
            </div>
            <form id="product-form">
                <input type="hidden" id="product-id">
                <div class="form-group">
                    <label for="product-name">Nome do Produto *</label>
                    <input type="text" id="product-name" class="neo-input" required>
                </div>
                <div class="form-group">
                    <label>Localiza√ß√µes e Quantidades</label>
                    <div id="locations-container" class="locations-grid">
                        <!-- Campos de localiza√ß√£o ser√£o inseridos aqui -->
                    </div>
                </div>
                <button type="submit" class="btn-submit" id="save-product-btn">Salvar Produto</button>
            </form>
        </div>
    </div>

    <!-- Modal de Confirma√ß√£o de Exclus√£o -->
    <div id="delete-confirm-modal-overlay" class="modal-overlay hidden">
        <div class="modal-content">
            <div class="modal-header">
                <h2 class="premium-title">Confirmar Exclus√£o</h2>
            </div>
            <p class="confirm-modal-text">
                Tem certeza que deseja excluir o item <span id="item-to-delete-name"></span>? Esta a√ß√£o n√£o pode ser desfeita.
            </p>
            <div class="confirm-buttons">
                <button class="btn-cancel" id="cancel-delete-btn">Cancelar</button>
                <button class="btn-confirm" id="confirm-delete-btn">Excluir</button>
            </div>
        </div>
    </div>

    <!-- Modal de QR Code (Estrutura Premium) -->
    <div id="qrcode-modal-overlay" class="modal-overlay hidden">
        <div class="modal-content-lg">
            <div class="modal-header">
                <h2 id="qr-modal-title" class="premium-title">üî≥ QR Code do Produto:</h2>
                <button id="close-qrcode-modal-btn" class="close-button" title="Fechar"><i class="fas fa-times"></i></button>
            </div>
            <div class="modal-body qr-modal-body">
                <!-- Coluna da Pr√©-visualiza√ß√£o -->
                <div class="qr-preview-column">
                    <div id="qr-print-preview-area" class="qr-print-preview-area">
                        <div id="qrcode-container" class="qrcode-container">
                            <!-- Gerado pelo JS -->
                        </div>
                        <div id="qr-info-preview" class="qr-info-preview">
                            <!-- Remover estes elementos do modal -->
                            <!-- <h3 id="qr-info-product-name" class="qr-info-product-name">Nome do Produto</h3> -->
                            <!-- <p id="qr-info-main-location"><b>Local Principal:</b> <span>-</span></p> -->
                            <!-- <p id="qr-info-main-quantity"><b>Qtd. Principal:</b> <span>-</span></p> -->
                            <!-- <p id="qr-info-excess-location" class="hidden"><b>Excesso:</b> <span>-</span></p> -->
                        </div>
                    </div>
                </div>

                <!-- Coluna de Controles -->
                <div class="qr-controls-column">
                    <div class="control-group">
                        <label>üìÑ Posi√ß√£o das Informa√ß√µes</label>
                        <div class="segmented-control">
                            <button class="btn-segment active" data-position="below">Abaixo</button>
                            <button class="btn-segment" data-position="right">Ao Lado</button>
                        </div>
                    </div>

                    <div class="control-group">
                        <label>üé® Ajustes do QR Code</label>
                        <div class="form-group-inline">
                            <label for="qr-size-input">Tamanho (px)</label>
                            <input type="range" id="qr-size-input" min="50" max="1000" value="200" class="slider">
                            <span id="qr-size-value">200px</span>
                        </div>
                         <div class="form-group-inline">
                            <label for="qr-color-primary">Cor Prim√°ria</label>
                            <input type="color" id="qr-color-primary" value="#111827" class="color-input">
                        </div>
                        <div class="form-group-inline">
                            <label for="qr-color-eyes">Cor dos Olhos</label>
                            <input type="color" id="qr-color-eyes" value="#fbbf24" class="color-input">
                        </div>
                    </div>

                    <div class="control-group">
                        <label>üß∞ A√ß√µes</label>
                        <div class="action-buttons-grid">
                            <button id="btn-view-product-page" class="btn btn-secondary" title="Abrir p√°gina do produto em nova aba"><i class="fas fa-external-link-alt"></i> Visualizar</button>
                            <button id="btn-print-qr" class="btn btn-primary" title="Imprimir etiqueta"><i class="fas fa-print"></i> Imprimir</button>
                            <button id="btn-download-qr" class="btn btn-secondary" title="Baixar como imagem PNG"><i class="fas fa-download"></i> Baixar PNG</button>
                            <button id="btn-copy-link" class="btn btn-secondary" title="Copiar link do produto"><i class="fas fa-copy"></i> Copiar Link</button>
                            <button id="btn-edit-print-text" class="btn btn-secondary" title="Editar escrita da etiqueta"><i class="fas fa-pen"></i> Editar Escrita</button>
                        </div>
                        
                        <!-- Container para editar escrita (inicialmente oculto) -->
                        <div id="edit-print-text-container" class="hidden" style="margin-top: 15px; padding: 15px; background: rgba(0,0,0,0.2); border-radius: 8px;">
                            <div class="form-group">
                                <label for="input-print-text">Texto da Etiqueta</label>
                                <textarea id="input-print-text" class="neo-input" rows="3" placeholder="Digite o texto que aparecer√° na etiqueta..."></textarea>
                            </div>
                            <div style="display: flex; gap: 10px; margin-top: 10px;">
                                <button id="btn-save-print-text" class="btn btn-primary">Salvar Texto</button>
                                <button id="btn-cancel-print-text" class="btn btn-secondary">Cancelar</button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Toast Notifications -->
    <div id="toast-container"></div>

    <!-- Overlay de Carregamento -->
    <div id="loader-overlay" class="hidden">
        <div class="loader"></div>
    </div>

    <!-- Scripts -->
    <script src="https://cdn.jsdelivr.net/npm/qr-code-styling@1.5.0/lib/qr-code-styling.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/xlsx@0.18.5/dist/xlsx.full.min.js"></script>
    <script src="../js/layout.js"></script>
    <script src="../js/estoque.js"></script>
</body>
</html> 